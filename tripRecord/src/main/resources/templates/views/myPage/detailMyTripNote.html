<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="initial-scale=1, width=device-width">
<title>내 여행노트 상세보기</title>
<style>
</style>
<link rel="stylesheet" href="css/plan/detailMyTripNote.css" type="text/css" />
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js"></script>
<link type="text/css" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/themes/base/jquery-ui.css" rel="stylesheet">
<link rel="stylesheet" href="css/plan/datepicker.css" type="text/css" />
<link rel="icon" href="image/icon_case.ico" type="image/x-icon"/>
<link rel="shortcut icon" href="image/icon_case.ico" type="image/x-icon"/>
</head>
<body>
	<!-- 헤더 -->
	<div th:replace="~{common/logoBar :: logoBar }"></div>
	<div th:replace="~{common/mainCategoryBar :: mainCategoryBar}"></div>
	
	<div th:replace="~{common/myPageUpperBar :: myPageUpperBar}"></div>
	<div style="height:120px;"></div>
	
	<form id="detailMyTripForm">
		<div class="flex-container">
			<span class="secondSidebar"><a class="nav-link" href="myPlan.mp">플래너일정요청리스트</a></span>
        	<span class="secondSidebar"><a class="nav-link" href="myTripNote.mp">내 여행 노트</a></span>
			
			<div id="contain-all-div">
				<div id="title-div">내 여행노트</div>
				<div class="contain-div" id="detailForm">
					<div class="inline-contain-div">
						<span class="textSpan" id="startDate-span" th:text="${s.startDate}"></span>
						<span class="textSpan">-</span> 
						<span class="textSpan" id="endDate-span" th:text="${s.endDate}"></span> 
						<span class="textSpan">동안</span>
					</div>
					<div class="inline-contain-div">
						<span class="textSpan" id="spot-span" th:text="${s.spot}"></span>
						<span class="textSpan">(으)로 떠나는 여행 계획입니다</span>
					</div>
					<div class="editButton-div">
						<button type="button" class="runButton" id="editButton">수정</button>
						<input type="hidden" name="scNo" th:value="${s.scNo}" id="scNo"/>
					</div>				
				</div>
				
				<div class="contain-div" id="editForm" style="display: none;">
					<div class="inline-contain-div edit-div">
						<input type="text" id="sdate" class="datepicker" name="startDate" th:value="${s.startDate}" /> 
						<span class="textSpan">-</span> 
						<input type="text" id="edate" class="datepicker" name="endDate" th:value="${s.endDate}" /> 
						<span class="textSpan">동안</span>
					</div>
					<div class="inline-contain-div edit-div">
						<select id="selectSpotHidden" name="spot" class="form-select selectOption">
							<option class="select_opt" value="1" th:selected="${ spot == '서울' }">서울</option>
							<option class="select_opt" value="2" th:selected="${ spot == '인천' }">인천</option>
							<option class="select_opt" value="3" th:selected="${ spot == '대전' }">대전</option>
							<option class="select_opt" value="4" th:selected="${ spot == '대구' }">대구</option>
							<option class="select_opt" value="5" th:selected="${ spot == '광주' }">광주</option>
							<option class="select_opt" value="6" th:selected="${ spot == '부산' }">부산</option>
							<option class="select_opt" value="7" th:selected="${ spot == '울산' }">울산</option>
							<option class="select_opt" value="8" th:selected="${ spot == '세종' }">세종</option>
							<option class="select_opt" value="31" th:selected="${ spot == '경기' }">경기</option>
							<option class="select_opt" value="32" th:selected="${ spot == '강원' }">강원</option>
							<option class="select_opt" value="33" th:selected="${ spot == '충북' }">충북</option>
							<option class="select_opt" value="34" th:selected="${ spot == '충남' }">충남</option>
							<option class="select_opt" value="35" th:selected="${ spot == '경북' }">경북</option>
							<option class="select_opt" value="36" th:selected="${ spot == '경남' }">경남</option>
							<option class="select_opt" value="37" th:selected="${ spot == '전북' }">전북</option>
							<option class="select_opt" value="38" th:selected="${ spot == '전남' }">전남</option>
							<option class="select_opt" value="39" th:selected="${ spot == '제주' }">제주</option>
						</select> <span class="textSpan">(으)로 떠나는 여행 계획입니다</span>
					</div>
					<div class="editButton-div">
						<button type="button" id="completeButton" class="runButton">완료</button>
						<button type="button" id="cancelButton" class="notButton">취소</button>
					</div>
				</div>
				
				<!-- 내 여행 일정 -->
				<div class="contain-div">
					<div id="planAll" class="grid">
						<div class="dayPlan g-col-6 g-col-md-4" th:each="date : ${dates}">
							<div class="dayText" th:text="|${date.key}일차|"></div>
							<div class="date" th:text="${date.value}"></div>
							<div class="planDiv">
								<div class="one-plan" th:each="p, index : ${pList}" th:if="${date.value == p.day}">
									<input type="hidden" name="plNo" class="plNos" th:value="${p.plNo}"/>
									<input type="hidden" name="day" th:value="${p.day}"/>
									<div class="plan-spans">
										<span class="line"><span class="round"></span></span>
									</div>
									<div class="plan-labels">
										<div class="label-div">
											<input type="text" name="place" th:value="${p.place}" class="plan-text placeInput" maxlength="20" placeholder="장소 입력창" style="display: none;">
											<label class="planLabel placeLabel" th:text=${p.place}></label>
										</div>
										<div class="label-div">
											<input type="time" name="time" th:value="${p.time}" class="plan-text timeInput" placeholder="시간 입력창" style="display: none;">
											<label class="planLabel timeLabel" th:text="${p.time}"></label>
											<div class="plan-checks">
												<div class="checkbox-wrapper-46">
													<input type="checkbox" th:id="|cbx${index.index}|" class="inp-cbx" th:checked="${p.reserve == 'Y'}"><label th:for="|cbx${index.index}|" class="cbx">
													<span class="cbSvg"><svg viewBox="0 0 12 10" class="cbSvg" height="10px" width="12px"><polyline points="1.5 6 4.5 9 10.5 1"></polyline></svg></span><span class="reserveText">예약 여부</span></label>
												</div>
											</div>
										</div>
										<div class="label-div">
											<input type="text" name="memo" th:value="${p.memo}" class="plan-text memoInput" maxlength="42" placeholder="메모 입력창" style="display: none;">
											<label class="planLabel memoLabel" th:text="${p.memo}"></label>
										</div>
									</div>
									<div class="plan-images"></div>
								</div>
							</div>
							<div class="addButton-div">
								<button class="placeAddButton" type="button">장소 추가</button>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- 제출버튼 -->
			<div id="buttons-div">
				<button id="back_button" type="button">뒤로가기</button>
				<button id="delete_button" type="button">삭제</button>
			</div>
		</div>
	</form>
	<div style="margin-bottom: 400px"></div>
	<!-- 푸터 -->
	<div th:replace="~{common/footer :: footer}"></div>
	
	<script th:inline="javascript">
		/*<![CDATA[*/
		let page = /*[[${page}]]*/1;
		/*]]>*/
		
		document.getElementById('back_button').addEventListener('click', () =>{
			 window.history.back();
		})
		
		window.onload = () => {
			
			const form = document.getElementById('detailMyTripForm');
			
			document.getElementById('delete_button').addEventListener('click', function(){
				if(confirm("정말 삭제하시겠습니까?")){
					form.action = "deleteTripNote.mp";
					form.method = "post";
					form.submit();
				} else {
					//console.log('좋습니다');
				}
				
			});
			
			document.querySelectorAll('.placeAddButton').forEach(function(addButton) {
				addButton.addEventListener('click', function(e){
					let planDiv = e.target.parentElement.previousElementSibling;
					
					const newOnePlan = document.createElement('div');
					newOnePlan.classList.add('one-plan');
					
					const planSpans = document.createElement('div');
					planSpans.classList.add('plan-spans');
					planSpans.innerHTML = '<span class="line"><span class="round"></span></span>';
					
					let ii = 1;
					const planInputs = document.createElement('div');
					planInputs.classList.add('plan-inputs');
					planInputs.innerHTML = '<div><input type="text" class="plan-text placeInput" name="place" placeholder="장소 입력창"></div><div><input type="time" name="time" class="plan-text timeInput" placeholder="시간 입력창"></div><div><input type="text" name="memo" class="plan-text memoInput" placeholder="메모 입력창"></div>';
					ii++;
					
					const planImages = document.createElement('div');
					planImages.classList.add('plan-images');
					planImages.innerHTML = '<img class="planInputIcon check-icon" style="width: 16px; height: 17px;" src="image/Check.png"/>'
					+ ' <img class="planInputIcon trash-icon" style="width: 18px; height: 17px;" src="image/Trash.png"/>';
					
					newOnePlan.appendChild(planSpans);
					newOnePlan.appendChild(planInputs);
					newOnePlan.appendChild(planImages);
					
					planDiv.appendChild(newOnePlan);
				});
			});
			
			let index = 1; // 
			let labelDiv = '';
			
			const timeReg = /^([01]\d|2[0-3]):([0-5]\d)$/;
			
			let originalPlace, originalTime, originalMemo; // 기존에 있던 값 담을 변수
			
			let placeLabel, timeLabel, memoLabel, plNo; // update 할 때 ajax 로 보낼 변수
			
			document.getElementById('planAll').addEventListener('click', function(e){
				if (e.target.classList.contains('check-icon')) {
					let onePlan = e.target.closest('.one-plan');
					let inputs = onePlan.querySelectorAll('input.plan-text');
					
					let placeInput = inputs[0];
					let timeInput = inputs[1];
					let memoInput = inputs[2];
					
					plNo = onePlan.children[0].value;
					
					if(placeInput.value.trim() != '' && timeInput.value.trim() != ''){
						if(!timeReg.test(timeInput.value)){
							alert('올바른 시간을 입력해 주세요.');
						}
						
						let label = null;
						inputs.forEach(function(input) {
							let value = input.value;
							label = document.createElement('label');
							label.innerText = value;
							
							if(input == inputs[2] && value == ""){
								input.value = "-";
							}
							
							label.classList.add('planLabel');
							input.style.display = 'none';
							
							if(input == inputs[0]){
								label.classList.add('placeLabel');
								placeLabel = label.innerText;
							} else if(input == inputs[1]){
								label.classList.add('timeLabel');
								timeLabel = label.innerText;
							} else if(input == inputs[2]){
								label.classList.add('memoLabel');
								memoLabel = label.innerText;
							}
							
							input.parentNode.insertBefore(label, input.nextSibling);
							label.parentElement.className = 'label-div';
							label.parentElement.parentElement.style.background = 'none';
						});
						
						detailPlanUpdate(); // update ajax 함수

						let icons = onePlan.querySelectorAll('img.planInputIcon');
						icons.forEach(function(icon) {
							icon.remove();
						});
						
						let checkDiv = document.createElement('div');
						checkDiv.classList.add('plan-checks');
						checkDiv.innerHTML = '<div class="checkbox-wrapper-46"><input type="checkbox" id="cbx' + index + '" class="inp-cbx planCheck" /><label for="cbx' + index + '" class="cbx planCheck"><span class="cbSvg"><svg class="cbSvg" viewBox="0 0 12 10" height="10px" width="12px"><polyline points="1.5 6 4.5 9 10.5 1"></polyline></svg></span><span class="reserveText"> 예약 여부</span></label></div>';
						index++;
						
						let timelabelDiv = timeInput.parentElement;
						timelabelDiv.appendChild(checkDiv);
						onePlan.children[3].className = 'plan-labels';
						
					} else {
						alert('계획을 입력해 주세요.');
					}
		        } else if (e.target.classList.contains('trash-icon')) {
		            let onePlan = e.target.closest('.one-plan');
		            let planDiv = e.target.closest('.planDiv');
		            let onePlans = planDiv.querySelectorAll('.one-plan');
		            
		            let count = 0;
		            
		            for(let i = 0; i < onePlans.length; i++){
		            	count++;
		            }
		            
		            if(count > 1){
			            plNo = onePlan.children[0].value;
			            
			            $.ajax({
			            	url: 'detailDeletePlan.mp',
			            	data: {plNo:plNo},
			            	success: data => {
								if(data == "1") {
				            		onePlan.remove();
								} else {
									alert('일정 삭제에 실패했습니다.');
								}
			            	},
			            	error: data => console.log(data)
			            });
		            } else {
		            	alert('한 개의 일정은 존재해야 합니다.');
		            }
		            
		        } else if (e.target.classList.contains('planLabel') || e.target.classList.contains('label-div')) {
		        	let bgCheckDiv = document.querySelectorAll('.plan-labels');
	        		for(const bgDiv of bgCheckDiv){
	        			if(bgDiv.style.background != 'none') {
	        				bgDiv.style.background = 'none';
	        				bgDiv.nextElementSibling.innerHTML = '';
	        			}
	        		}
	        		
		        	if(e.target.classList.contains('planLabel')){
			        	labelDiv = e.target.parentElement.parentElement;
		        	} else {
			        	labelDiv = e.target.parentElement;
		        	}
		        	
		        	labelDiv.style.background = '#E9F5FE';
		        	let imagesDiv = labelDiv.nextElementSibling;
		        	labelDiv.classList.add('edit-labels');
		        	imagesDiv.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16"><path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/><path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z"/></svg><br/><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash trash-icon" viewBox="0 0 16 16"><path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"/><path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"/></svg>';
		        	
		        } else if(e.target.classList.contains('bi-pencil-square')) {
		        	let onePlan = e.target.closest('.one-plan');
					let labels = onePlan.querySelectorAll('.planLabel');

					labels.forEach(function(label) {
						let input = label.previousElementSibling;
						input.value = label.innerText;
						if(label == labels[0]){
							originalPlace = label.innerText;
						} else if(label == labels[1]){
							originalTime = label.innerText;
						} else if(label == labels[2]){
							originalMemo = label.innerText;
						}
						label.remove();
						input.style.display = 'inline';
					});

					onePlan.querySelector('.plan-checks').remove();
					
					let plLabels = onePlan.querySelector('.plan-labels');
					plLabels.className = 'plan-inputs edit-inputs';
					
					let childDivs = plLabels.querySelectorAll('div');
					
					childDivs.forEach(function(classRemove) {
						classRemove.classList.remove('label-div');
					});
					
					onePlan.querySelector('.plan-images').innerHTML = '<img class="planInputIcon check-icon edit-image" style="width: 16px; height: 17px;" src="image/Check.png"/>&nbsp;<img class="planInputIcon trash-icon edit-image" style="width: 18px; height: 17px;" src="image/Trash.png"/>';
		       
		        } else if(e.target.classList.contains('plan-checks') || e.target.classList.contains('checkbox') ||
		        		  e.target.classList.contains('cbx') || e.target.classList.contains('reserveText') ||
		        		  e.target.classList.contains('cbSvg')) {
		        	let onePlan = e.target.closest('.one-plan');
		        	let checkbox = onePlan.querySelector('.inp-cbx');
		        	
		        	plNo = onePlan.children[0].value;
		        	let status;
		        	
		        	if(!checkbox.checked) status = 'Y';
		        	else status = 'N';
		        	
		        	//console.log(status);
		        	
		        	$.ajax({
		        		url: 'updateReserve.mp',
		        		data: {
		        			plNo:plNo,
		        			status:status
		        		},
		        		success: data => {
		        			if(data == '0') {
		        				if(status == 'N') {
		        					checkbox.checked = false;
		        				}
		        				else {
		        					checkbox.checked = true;
		        				}
		        				
		        				alert('예약 여부 변경에 실패하였습니다.');
		        			}
		        		},
		        		error: data => console.log(data)
		        	});
		        }
		    });
			
			document.querySelector('body').addEventListener('click', e => {
				// label 클릭한 후 다른 곳 클릭하면 배경색 없어지고 펜이랑 휴지통 아이콘 사라지는 스크립트
				let editLabels = document.querySelector('.edit-labels');
				
				if(editLabels != null){
					let onePlan = editLabels.closest('.one-plan');
					let labelDivs = Array.from(onePlan.querySelectorAll('.label-div'));
					let planTexts = Array.from(onePlan.querySelectorAll('.plan-text'));
					let planLabel = Array.from(onePlan.querySelectorAll('.planLabel'));
					let planChecks = onePlan.querySelector('.plan-checks');
					let planCheck = Array.from(planChecks.querySelectorAll('planCheck'));
					
					if(e.target != onePlan && e.target != planChecks && 
					   !planTexts.includes(e.target) && !planLabel.includes(e.target) &&
					   !labelDivs.includes(e.target) && !planCheck.includes(e.target)){
						
						editLabels.style.background = 'none';
						editLabels.classList.remove('edit-labels');
						editLabels.nextElementSibling.innerHTML = '';
					}
					
				}
				
				// 입력 완료 후 label click -> pencil icon click -> 수정 중일 때 다른 곳 클릭하면 돌아가는 스크립트
				let editInputs = document.querySelector('.edit-inputs');
				
				if(editInputs != null && !e.target.classList.contains('bi')){
					
					let planText = Array.from(editInputs.querySelectorAll('input.plan-text'));
					
					if(e.target != editInputs && !planText.includes(e.target) && 
					   editInputs.style.background != 'none'){
						
						editInputs.style.background = 'none';
						editInputs.classList.remove('edit-inputs');
						
						if(planText[0].value.trim() == '') planText[0].value = originalPlace;
						if(planText[1].value.trim() == '') {
							if(!timeReg.test(originalTime)){
								originalTime = '12:00';
							}
							planText[1].value = originalTime;
						}
						
						if(planText[2].value.trim() == '') planText[2].value = originalMemo;
						
						labelChange(planText, editInputs);
					}
					
				}
			})
			
			function labelChange(planText, editInputs){
				let label = null;
				
				let placeInput = planText[0];
				let timeInput = planText[1];
				let memoInput = planText[2];
				
				plNo = editInputs.parentElement.children[0].value;
				
				for(const input of planText){
					let value = input.value;
					label = document.createElement('label');
					label.innerText = value;
					
					label.classList.add('planLabel');
					input.style.display = 'none';
					
					if(input.classList.contains('placeInput')){
						label.classList.add('placeLabel');
						placeLabel = label.innerText;
					} else if(input.classList.contains('timeInput')){
						label.classList.add('timeLabel');
						timeLabel = label.innerText;
					} else if(input.classList.contains('memoInput')){
						label.classList.add('memoLabel');
						memoLabel = label.innerText;
					}
					
					input.parentNode.insertBefore(label, input.nextSibling);
					label.parentElement.className = 'label-div';
					label.parentElement.parentElement.style.background = 'none';
				}
				
				editInputs.nextElementSibling.innerHTML = '';

				detailPlanUpdate(); // update ajax
				
				let checkDiv = document.createElement('div');
				checkDiv.classList.add('plan-checks');
				checkDiv.innerHTML = '<div class="checkbox-wrapper-46"><input type="checkbox" id="cbx' + index + '" class="inp-cbx planCheck" /><label for="cbx' + index + '" class="cbx planCheck"><span><svg viewBox="0 0 12 10" class="cbx" height="10px" width="12px"><polyline points="1.5 6 4.5 9 10.5 1"></polyline></svg></span><span class="reserveText"> 예약 여부</span></label></div>';
				index++;
				
				let planLabelsDiv = editInputs.children[1];
				planLabelsDiv.appendChild(checkDiv);
				editInputs.className = 'plan-labels';
			}
			
			// 날짜, 지역 수정
			originalStart = '';
			originalEnd = '';
			originalSpot = '';
			
			const detailForm = document.getElementById('detailForm');
			const editForm = document.getElementById('editForm');
			document.getElementById('editButton').addEventListener('click', () => {
				detailForm.style.display = 'none';
				editForm.style.display = 'block';
				
				originalStart = $('#startDate-span').text();
				originalEnd = $('#endDate-span').text();
				originalSpot = $('#spot-span').text();
				
				$('#sdate').val(originalStart);
				$('#edate').val(originalEnd);
				$('#selectSpotHidden').val(originalSpot);
			});

// 			수정 저장하기(지역 (으)로 떠나는 여행 계획입니다 오른쪽에)
			document.getElementById('completeButton').addEventListener('click', function(){
				detailForm.style.display = 'block';
				editForm.style.display = 'none';
				
				let newStartDate = $("#sdate").val();
				let newEndDate = $("#edate").val();
				let newSpot = $('#selectSpotHidden option:checked').text();
				
				$('#startDate-span').text(newStartDate);
				$('#endDate-span').text(newEndDate);
				$('#spot-span').text(newSpot);
				
				$.ajax({
					url: 'updateValue.mp',
					method: 'POST',
					data: { 
						startDate:newStartDate,
						endDate:newEndDate,
						spot:newSpot
					},
					success: function(map) {
						let p = map.p;
						let dates = map.dates;
						
						$('#planAll').empty();
						$.each(dates, function(key, value) {
							// n일차 + 날짜
							let dayTextHtml = '<div class="dayText">' + key + '일차</div>';
							let dateHtml = '<div class="date">' + value + '</div>';
						
							// input 입력창
							let planInputsHtml = '<div class="plan-inputs"><div><input type="text" class="plan-text placeInput" maxlength="20" placeholder="장소 입력창"></div><div><input type="time" class="plan-text timeInput" placeholder="시간 입력창"></div><div><input type="text" class="plan-text memoInput" maxlength="42" placeholder="메모 입력창"></div></div>';
						
							// 1개의 계획 + 라인 + 원
							let onePlanHtml = '<div class="one-plan"><div class="plan-spans"><span class="line"><span class="round"></span></span></div> ' + planInputsHtml + '<div class="plan-images"><img class="planInputIcon check-icon" style="width: 16px; height: 17px;" src="image/Check.png"/><img class="planInputIcon trash-icon" style="width: 18px; height: 17px;" src="image/Trash.png"/></div></div>';
						
							// 버튼
							let buttonsHtml = '<div class="addButton-div"> <button class="placeAddButton editB" type="button">장소 추가</button> </div>';
							
							// planDiv 안에 1개 계획 넣기
							let planDivHtml = '<div class="planDiv">' + onePlanHtml + '</div>';
						
							// 1일차를 감싸는 계획 div
							let newDayPlan = '<div class="dayPlan"> ' + dayTextHtml + dateHtml + planDivHtml + buttonsHtml + ' </div>';
						
							$('#planAll').append(newDayPlan);
						});
					},
					error: data => console.log(data)
				})
				
				
				$('#spot').val(newSpot);
			})
			
// 			수정 취소
			document.getElementById('cancelButton').addEventListener('click', () => {
				detailForm.style.display = 'block';
				editForm.style.display = 'none';
			});
			
			function detailPlanUpdate(){
				$.ajax({
					url:'detailTripUpdate.mp',
					data: {
						place:placeLabel,
						time:timeLabel,
						memo:memoLabel,
						plNo:plNo
					},
					success: data => {
						if(data == '0') {
							onePlan.querySelector('.placeLabel').innerText = originalPlace;
							onePlan.querySelector('.timeLabel').innerText = originalTime;
							onePlan.querySelector('.memoLabel').innerText = originalMemo;
							
							alert('일정 수정에 실패하였습니다.');
						}
					},
					error: data => console.log(data)
				});
			}
			
			$(document).ready(function() {
				$(".datepicker").datepicker({
					inline: true,
					dateFormat: 'yy/mm/dd',
					prevText: '이전 달',
					nextText: '다음 달',
					monthNames: ['1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월', '11월', '12월'],
					monthNamesShort: ['1월', '2월', '3월', '4월', '5월', '6월', '7월', '8월', '9월', '10월', '11월', '12월'],
					dayNames: ['일', '월', '화', '수', '목', '금', '토'],
					dayNamesShort: ['일', '월', '화', '수', '목', '금', '토'],
					dayNamesMin: ['일', '월', '화', '수', '목', '금', '토'],
					showMonthAfterYear: true,
					yearSuffix: '년'
				});
				
				$('#sdate').datepicker("option", "minDate", 0);
				$('#sdate').datepicker("option", "onSelect", function (selectedDate){
					$('#sdate').val(selectedDate);
					
					$("#edate").datepicker("option", "minDate", selectedDate);
					
					let maxDate = $.datepicker.parseDate('yy/mm/dd', selectedDate);
					maxDate.setDate(maxDate.getDate() + 21);
					$("#edate").datepicker("option", "maxDate", $.datepicker.formatDate('yy/mm/dd', maxDate));
			    });
				
				$('#edate').datepicker("option", "onSelect", function(selectedDate){
					$('#edate').val(selectedDate);
				});
			});
		}
	</script>
</body>
</html>